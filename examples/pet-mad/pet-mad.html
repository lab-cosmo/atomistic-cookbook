<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../../search.html"><link rel="next" title="Uncertainty Quantification with PET-MAD" href="../pet-mad-uq/pet-mad-uq.html"><link rel="prev" title="Sample and Feature Selection with FPS and CUR" href="../sample-selection/sample-selection.html">
        <link rel="canonical" href="https://atomistic-cookbook.org/examples/pet-mad/pet-mad.html">
        <link rel="prefetch" href="../../_static/cookbook-icon.svg" as="image">

    <link rel="shortcut icon" href="../../_static/cookbook-icon.png"><!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>The PET-MAD universal potential - The Atomistic Cookbook</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/cookbook.css?v=d86cfb60" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">The Atomistic Cookbook</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/cookbook-icon.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">The Atomistic Cookbook</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../topics/index.html">Recipes grouped by topic</a><input aria-label="Toggle navigation of Recipes grouped by topic" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../topics/sampling.html">Statistical sampling and dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../topics/analysis.html">Analysis and post-processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../topics/ml-models.html">Machine learning models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../topics/universal.html">Universal ML models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../topics/nqes.html">Nuclear quantum effects</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software/index.html">Recipes grouped by software used</a><input aria-label="Toggle navigation of Recipes grouped by software used" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software/chemiscope.html">chemiscope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/cp2k.html">cp2k</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/eon.html">eon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/featomic.html">featomic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/gromacs.html">GROMACS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/i-pi.html">i-PI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/lammps.html">LAMMPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/metatensor.html">metatensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/plumed.html">PLUMED</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/scikit-matter.html">scikit-matter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/torch-pme.html">torch-pme</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../all-examples.html">List of all recipes</a><input aria-label="Toggle navigation of List of all recipes" checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../dos-align/dos-align.html">A ML model for the electron density of states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../water-model/water-model.html">Atomistic Water Model for Molecular Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../batch-cp2k/reference-trajectory.html">Batch run of CP2K calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shiftml/shiftml-example.html">Computing NMR shielding tensors using ShiftML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pet-finetuning/pet-ft-nc.html">Conservative fine-tuning for a PET model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thermostats/thermostats.html">Constant-temperature MD and thermostats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarizability/polarizability.html">Equivariant linear model for polarizability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learn-tensors-with-mcov/learn-tensors-with-mcov.html">Equivariant model for tensorial properties based on scalar features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eon-pet-neb/eon-pet-neb.html">Finding Reaction Paths with eOn and a Metatomic Potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pet-finetuning/pet-ft.html">Fine-tuning the PET-MAD universal potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../roy-gch/roy-gch.html">Generalized Convex Hull construction for the polymorphs of ROY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hamiltonian-qm7/hamiltonian-qm7.html">Hamiltonian Learning for Molecules with Indirect Targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../torchpme/torchpme_learning.html">Learning Capabilities with torchpme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lpr/lpr.html">Local Prediction Rigidity analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lode-linear/lode-linear.html">Long-distance Equivariants: a tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../flashmd/flashmd-demo.html">Long-stride trajectories with a universal FlashMD model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pet-mad-nc/pet-mad-nc.html">MD using direct-force predictions with PET-MAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metatomic-plumed/metatomic-plumed.html">ML collective variables in PLUMED with metatomic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pi-mts-rpc/mts-rpc.html">Multiple time stepping and ring-polymer contraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gaas-map/gaas-map.html">PCA/PCovR Visualization of a training dataset for a potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pi-metad/pi-metad.html">Path integral metadynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../path-integrals/path-integrals.html">Path integral molecular dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../periodic-hamiltonian/periodic-hamiltonian.html">Periodic Hamiltonian learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../heat-capacity/heat-capacity.html">Quantum heat capacity of water</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ring-polymer-instanton/rpi-rates.html">Ring Polymer Instanton Rate Theory: Tunneling Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rotate-equivariants/rotate-equivariants.html">Rotating equivariants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sample-selection/sample-selection.html">Sample and Feature Selection with FPS and CUR</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">The PET-MAD universal potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pet-mad-uq/pet-mad-uq.html">Uncertainty Quantification with PET-MAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../water-pulsed/water-pulsed.html">Water orientation in a pulsed electric field</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../downloading.html">Downloading and running the recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing a recipe</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-pet-mad-pet-mad-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="the-pet-mad-universal-potential">
<span id="sphx-glr-examples-pet-mad-pet-mad-py"></span><h1>The PET-MAD universal potential<a class="headerlink" href="#the-pet-mad-universal-potential" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Authors<span class="colon">:</span></dt>
<dd class="field-odd"><p>Philip Loche <a class="reference external" href="https://github.com/picocentauri">&#64;PicoCentauri</a>,
Michele Ceriotti <a class="reference external" href="https://github.com/ceriottm">&#64;ceriottm</a>,
Arslan Mazitov <a class="reference external" href="https://github.com/abmazitov">&#64;abmazitov</a></p>
</dd>
</dl>
<p>This example demonstrates how to use the PET-MAD model with ASE, <a class="reference external" href="https://ipi-code.org">i-PI</a> and <a class="reference external" href="https://lammps.org">LAMMPS</a>. PET-MAD is a “universal”
machine-learning forcefield trained on a dataset that aims to incorporate a very high
degree of structural diversity.</p>
<p>The point-edge transformer (PET) is an unconstrained architecture that achieves a high
degree of symmetry compliance through data augmentation during training (see the <a class="reference external" href="https://proceedings.neurips.cc/paper_files/paper/2023/file/fb4a7e3522363907b26a86cc5be627ac-Paper-Conference.pdf">PET
paper</a>
for more details). The unconstrained nature of the model simplifies its implementation
and structure, making it computationally efficient and very expressive.</p>
<p>The MAD dataset combines “stable” inorganic structures from the
<a class="reference external" href="https://mc3d.materialscloud.org/">MC3D dataset</a>,
2D structures from the
<a class="reference external" href="https://mc2d.materialscloud.org/">MC2D dataset</a>,
and molecular crystals from the
<a class="reference external" href="https://archive.materialscloud.org/record/2022.147">ShiftML dataset</a>
with “Maximum Atomic Diversity” configurations, generated by distorting the composition
and structure of these stable templates. By doing so, PET-MAD achieves state-of-the-art
accuracy despite the MAD dataset containing fewer than 100k structures. The reference
DFT settings are highly converged, but limited to a PBEsol functional, so the accuracy
against experimental data depends on how good this level of theory is for a given
system. PET-MAD is introduced, and benchmarked for several challenging modeling tasks,
in <a class="reference external" href="https://arxiv.org/abs/2503.14118">this preprint</a>.</p>
<p>Start by importing the required libraries. To use PET-MAD,
and obtain all the necessary dependencies, you can simply use pip
to install the <a class="reference external" href="https://github.com/lab-cosmo/pet-mad">PET-MAD package</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>pet-mad
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

<span class="c1"># ASE and i-PI scripting utilities</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ase.units</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># pet-mad ASE calculator</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">metatomic.torch</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">LBFGS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipi.utils.mathtools</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_rotation_quadrature_lebedev</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipi.utils.parsing</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_output</span><span class="p">,</span> <span class="n">read_trajectory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipi.utils.scripting</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">InteractiveSimulation</span><span class="p">,</span>
    <span class="n">forcefield_xml</span><span class="p">,</span>
    <span class="n">motion_nvt_xml</span><span class="p">,</span>
    <span class="n">simulation_xml</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pet_mad.calculator</span><span class="w"> </span><span class="kn">import</span> <span class="n">PETMADCalculator</span>
</pre></div>
</div>
<section id="inference-on-the-mad-test-set">
<h2>Inference on the MAD test set<a class="headerlink" href="#inference-on-the-mad-test-set" title="Link to this heading">¶</a></h2>
<p>We begin by using the <code class="docutils literal notranslate"><span class="pre">ase</span></code>-compatible calculator to evaluate energy and forces for
a test dataset that contains both hold-out structures from the MAD dataset, and a few
structures from popular datasets (<a class="reference external" href="https://figshare.com/articles/dataset/Materials_Project_Trjectory_MPtrj_Dataset/23713842?file=41619375">MPtrj</a>,
<a class="reference external" href="https://alexandria.icams.rub.de/">Alexandria</a>,
<a class="reference external" href="https://paperswithcode.com/dataset/oc20">OC2020</a>,
<a class="reference external" href="https://www.nature.com/articles/s41597-022-01882-6">SPICE</a>,
<a class="reference external" href="https://www.science.org/doi/10.1126/sciadv.adf0873">MD22</a>) re-computed
with consistent DFT settings.</p>
<section id="load-the-dataset">
<h3>Load the dataset<a class="headerlink" href="#load-the-dataset" title="Link to this heading">¶</a></h3>
<p>We fetch the dataset, and load only some of the structures, to speed up the example
runtime on CPU. The model can also run (much faster) on GPUs if you have some at hand.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;data/mad-test-mad-settings.xyz&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;https://huggingface.co/lab-cosmo/pet-mad/resolve/&quot;</span>
        <span class="s2">&quot;main/benchmarks/mad-test-mad-settings.xyz&quot;</span>
    <span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">test_structures</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;::15&quot;</span><span class="p">)</span>

<span class="c1"># also extract reference energetics and metadata</span>
<span class="n">test_energy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_forces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_natoms</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_origin</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">subsets</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">test_structures</span><span class="p">:</span>
    <span class="n">test_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">())</span>
    <span class="n">test_natoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">test_forces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get_forces</span><span class="p">())</span>
    <span class="n">test_origin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subsets</span><span class="p">:</span>
        <span class="n">subsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">])</span>

<span class="n">test_natoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_natoms</span><span class="p">)</span>
<span class="n">test_origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_origin</span><span class="p">)</span>
<span class="n">test_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_energy</span><span class="p">)</span>
<span class="n">test_forces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_forces</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="single-point-energy-and-forces">
<h3>Single point energy and forces<a class="headerlink" href="#single-point-energy-and-forces" title="Link to this heading">¶</a></h3>
<p>PET-MAD is compatible with the metatomic models interface which allows us
to run it with ASE and many other MD engines. For more details see the <a class="reference external" href="https://docs.metatensor.org/metatomic">metatomic
documentation</a>.</p>
<p>We now load the PET-MAD ASE calculator and calculate energy and forces.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">calculator</span> <span class="o">=</span> <span class="n">PETMADCalculator</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.2&quot;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The model can also be exported in a format that can be used with
external MD engines. This is done by saving the model to a file,
which includes the model architecture and weights.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">calculator</span><span class="o">.</span><span class="n">calculator</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pet-mad-v1.0.2.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The model can also be loaded from this torchscript dump, which often
speeds up calculation as it involves compilation, and is functionally
equivalent unless you plan on fine-tuning, or otherwise modifying
the model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">calculator</span> <span class="o">=</span> <span class="n">mta</span><span class="o">.</span><span class="n">ase_calculator</span><span class="o">.</span><span class="n">MetatomicCalculator</span><span class="p">(</span><span class="s2">&quot;pet-mad-v1.0.2.pt&quot;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we run the computation on the CPU. If you have a CUDA GPU you can also set
<code class="docutils literal notranslate"><span class="pre">device=&quot;cuda&quot;</span></code> to speed up the computation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mad_energy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">mad_forces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">mad_structures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="n">test_structures</span><span class="p">:</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">calculator</span><span class="p">)</span>  <span class="c1"># avoids overwriting results.</span>
    <span class="n">mad_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">())</span>
    <span class="n">mad_forces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">get_forces</span><span class="p">())</span>
    <span class="n">mad_structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

<span class="n">mad_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mad_energy</span><span class="p">)</span>
<span class="n">mad_forces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mad_forces</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [2 3].
  self.calculate(atoms, [name], system_changes)
/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [0 1 2 3].
  self.calculate(atoms, [name], system_changes)
/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [36 37 38 39].
  self.calculate(atoms, [name], system_changes)
/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [2].
  self.calculate(atoms, [name], system_changes)
/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [0 1].
  self.calculate(atoms, [name], system_changes)
/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [4 5 6 7].
  self.calculate(atoms, [name], system_changes)
/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [26 27 28 29 30 31 32 33].
  self.calculate(atoms, [name], system_changes)
/home/runner/work/atomistic-cookbook/atomistic-cookbook/.nox/pet-mad/lib/python3.12/site-packages/ase/calculators/calculator.py:519: UserWarning: Some of the atomic energy uncertainties are larger than the threshold of 0.1 eV. The prediction is above the threshold for atoms [ 9 10 11 12 13 14 15].
  self.calculate(atoms, [name], system_changes)
</pre></div>
</div>
<p>A parity plot with the model predictions</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tab10</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;b:&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;b:&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subsets</span><span class="p">):</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test_origin</span> <span class="o">==</span> <span class="n">sub</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">mad_energy</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span> <span class="o">/</span> <span class="n">test_natoms</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span>
        <span class="n">test_energy</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span> <span class="o">/</span> <span class="n">test_natoms</span><span class="p">[</span><span class="n">sel</span><span class="p">],</span>
        <span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="n">tab10</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="n">label</span><span class="o">=</span><span class="n">sub</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">mad_forces</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">test_forces</span><span class="p">[</span><span class="n">sel</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="n">tab10</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
    <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;MAD energy / eV/atom&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Reference energy / eV/atom&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;MAD forces / eV/Å&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Reference forces / eV/Å&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">1.20</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_pet-mad_001.png" srcset="../../_images/sphx_glr_pet-mad_001.png" alt="pet mad" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f114cb86510&gt;
</pre></div>
</div>
<p>Explore the dataset using
<a class="reference external" href="http://chemiscope.org">chemiscope</a></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">chemiscope</span><span class="o">.</span><span class="n">show</span><span class="p">(</span>
    <span class="n">test_structures</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="n">test_origin</span><span class="p">,</span>
        <span class="s2">&quot;energy_ref&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">test_energy</span> <span class="o">/</span> <span class="n">test_natoms</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;eV/atom&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;energy_mad&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">mad_energy</span> <span class="o">/</span> <span class="n">test_natoms</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;eV/atom&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;energy_error&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_energy</span> <span class="o">-</span> <span class="n">mad_energy</span><span class="p">)</span> <span class="o">/</span> <span class="n">test_natoms</span><span class="p">),</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;eV/atom&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;force_error&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mad_forces</span><span class="p">,</span> <span class="n">test_forces</span><span class="p">,</span> <span class="n">test_natoms</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;eV/Å&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="n">shapes</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;forces_ref&quot;</span><span class="p">:</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">ase_vectors_to_arrows</span><span class="p">(</span>
            <span class="n">mad_structures</span><span class="p">,</span> <span class="s2">&quot;forces&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">),</span>
        <span class="s2">&quot;forces_mad&quot;</span><span class="p">:</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">ase_vectors_to_arrows</span><span class="p">(</span>
            <span class="n">test_structures</span><span class="p">,</span> <span class="s2">&quot;forces&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="n">settings</span><span class="o">=</span><span class="n">chemiscope</span><span class="o">.</span><span class="n">quick_settings</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;energy_mad&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;energy_ref&quot;</span><span class="p">,</span>
        <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;origin&quot;</span><span class="p">,</span>
        <span class="n">structure_settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;unitCell&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;forces_ref&quot;</span><span class="p">]},</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<!-- begin headers -->
<!-- Load all dependencies -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>

<!-- JS scripts -->
<script src="../../_static/chemiscope.min.js"></script>
<script src="../../_static/chemiscope-sphinx.js"></script>

<!-- CSS styles -->
<link rel="stylesheet" href="../../_static/chemiscope-sphinx.css" type="text/css" />
<!-- end headers -->

<!-- Error display -->
<div id="chsp-aad34d3a-02c6-4292-8d8a-4256c7bf78ac-error-display" class="chemiscope-sphinx-error">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-aad34d3a-02c6-4292-8d8a-4256c7bf78ac-error-display')">
        &times;
    </button>
</div>

<!-- Warning Display -->
<div id="chsp-aad34d3a-02c6-4292-8d8a-4256c7bf78ac-warning-display" class="chemiscope-sphinx-warning">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-aad34d3a-02c6-4292-8d8a-4256c7bf78ac-warning-display')">
        &times;
    </button>
</div>
<div style="padding: 0.5rem 1.25rem" />

<!-- Loading Spinner -->
<div id="chsp-aad34d3a-02c6-4292-8d8a-4256c7bf78ac-loading" class="chemiscope-sphinx-spinner">
    <img src="../../_static/chemiscope-loading.svg" alt="Loading icon" />
</div>

<!-- Chemiscope Visualization -->
<div id="chsp-aad34d3a-02c6-4292-8d8a-4256c7bf78ac">
    <!-- This will be replaced by the chemiscope HTML -->
</div>

<!-- Load Visualization Script -->
<script>
    loadChemiscopeSphinx('chsp-aad34d3a-02c6-4292-8d8a-4256c7bf78ac', '../../_datasets/18357a80826304df19c5c34231743f629d06764321f2041d2bd472e774ee124d-fig_pet-mad_001.json.gz', 'default', '2000.0');
</script>
<div class="output_subarea output_html rendered_html output_result">

</div>
<br />
<br /></section>
<section id="how-about-equivariance">
<h3>How about equivariance‽<a class="headerlink" href="#how-about-equivariance" title="Link to this heading">¶</a></h3>
<p>The PET architecture does not provide “intrinsically” invariant
energy predictions, but learns symmetry from data augmentation.
Should you worry? The authors of PET-MAD certainly do, and they
have <a class="reference external" href="http://doi.org/10.1088/2632-2153/ad86a0">studied extensively</a> whether
the symmetry breaking can cause serious artefacts. You can check by
yourself following the procedure below, that evaluates a structures
over a grid of rotations, estimating the variability in energy
(which is around 1meV/atom, much smaller than the test error).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rotations</span> <span class="o">=</span> <span class="n">get_rotation_quadrature_lebedev</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">rot_test</span> <span class="o">=</span> <span class="n">test_structures</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="n">rot_structures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rot_weights</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rot_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rot_forces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rot_angles</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">rot</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">angles</span> <span class="ow">in</span> <span class="n">rotations</span><span class="p">:</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rot_test</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">positions</span> <span class="o">@</span> <span class="n">rot</span><span class="o">.</span><span class="n">T</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">cell</span> <span class="o">@</span> <span class="n">rot</span><span class="o">.</span><span class="n">T</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">calculator</span><span class="p">)</span>
    <span class="n">rot_weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">rot_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>
    <span class="n">rot_forces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">get_forces</span><span class="p">())</span>
    <span class="n">rot_structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="n">rot_angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>

<span class="n">rot_energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rot_energies</span><span class="p">)</span>
<span class="n">rot_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rot_weights</span><span class="p">)</span>
<span class="n">rot_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rot_angles</span><span class="p">)</span>
<span class="n">erot_rms</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rot_energies</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rot_weights</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rot_weights</span><span class="p">)</span>
    <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rot_energies</span> <span class="o">*</span> <span class="n">rot_weights</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rot_weights</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">erot_max</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">rot_energies</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">rot_energies</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Symmetry breaking, energy:</span>
<span class="s2">RMS: </span><span class="si">{</span><span class="n">erot_rms</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> meV/at.</span>
<span class="s2">Max: </span><span class="si">{</span><span class="n">erot_max</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> meV/at.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Symmetry breaking, energy:
RMS: 0.283 meV/at.
Max: 1.004 meV/at.
</pre></div>
</div>
<p>You can also inspect the rotational behavior visually</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">chemiscope</span><span class="o">.</span><span class="n">show</span><span class="p">(</span>
    <span class="n">rot_structures</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;delta_energy&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="p">(</span><span class="n">rot_energies</span> <span class="o">-</span> <span class="n">rot_energies</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;eV/atom&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;euler_angles&quot;</span><span class="p">:</span> <span class="n">rot_angles</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">shapes</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;forces&quot;</span><span class="p">:</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">ase_vectors_to_arrows</span><span class="p">(</span>
            <span class="n">rot_structures</span><span class="p">,</span> <span class="s2">&quot;forces&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">50.0</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="n">settings</span><span class="o">=</span><span class="n">chemiscope</span><span class="o">.</span><span class="n">quick_settings</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;euler_angles[1]&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;euler_angles[2]&quot;</span><span class="p">,</span>
        <span class="n">z</span><span class="o">=</span><span class="s2">&quot;euler_angles[3]&quot;</span><span class="p">,</span>
        <span class="n">map_color</span><span class="o">=</span><span class="s2">&quot;delta_energy&quot;</span><span class="p">,</span>
        <span class="n">structure_settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;unitCell&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;forces&quot;</span><span class="p">]},</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>


<!-- Error display -->
<div id="chsp-19076548-7b64-47e2-b716-52000a608530-error-display" class="chemiscope-sphinx-error">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-19076548-7b64-47e2-b716-52000a608530-error-display')">
        &times;
    </button>
</div>

<!-- Warning Display -->
<div id="chsp-19076548-7b64-47e2-b716-52000a608530-warning-display" class="chemiscope-sphinx-warning">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-19076548-7b64-47e2-b716-52000a608530-warning-display')">
        &times;
    </button>
</div>
<div style="padding: 0.5rem 1.25rem" />

<!-- Loading Spinner -->
<div id="chsp-19076548-7b64-47e2-b716-52000a608530-loading" class="chemiscope-sphinx-spinner">
    <img src="../../_static/chemiscope-loading.svg" alt="Loading icon" />
</div>

<!-- Chemiscope Visualization -->
<div id="chsp-19076548-7b64-47e2-b716-52000a608530">
    <!-- This will be replaced by the chemiscope HTML -->
</div>

<!-- Load Visualization Script -->
<script>
    loadChemiscopeSphinx('chsp-19076548-7b64-47e2-b716-52000a608530', '../../_datasets/9f457a5f9bc85d72c6fd368baf848fdcb1bcbc94850c9af52f4a4605c77e0b77-fig_pet-mad_002.json.gz', 'default', '2000.0');
</script>
<div class="output_subarea output_html rendered_html output_result">

</div>
<br />
<br /><p>Note also that <a class="reference external" href="http://ipi-code.org">i-PI</a> provides functionalities to do this
automatically to obtain MD trajectories with a even higher degree of
symmetry-compliance.</p>
</section>
</section>
<section id="simulating-a-complex-surface">
<h2>Simulating a complex surface<a class="headerlink" href="#simulating-a-complex-surface" title="Link to this heading">¶</a></h2>
<p>PET-MAD is designed to be robust and stable when executing sophisticated
modeling workflows. As an example, we consider a slab of an Al-6xxx alloy
(aluminum with a few percent Mg and Si) with some oxygen molecules adsorbed
at the (111) surface.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The overall Si+Mg concentration in an Al6xxx alloy is far lower than what
depicted here. This is just a demonstrative example and should not be taken
as the starting point of a serious study of this system.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">al_surface</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;data/al6xxx-o2.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="geometry-optimization-with-ase">
<h3>Geometry optimization with <code class="docutils literal notranslate"><span class="pre">ASE</span></code><a class="headerlink" href="#geometry-optimization-with-ase" title="Link to this heading">¶</a></h3>
<p>As a first example, we use the <code class="docutils literal notranslate"><span class="pre">ase</span></code> geometry <cite>LBFGS</cite> optimizer to relax the initial
positions. This leads to the rapid decomposition of the oxygen molecules and the
formation of an oxide layer.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="n">al_surface</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calculator</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="n">traj_atoms</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">traj_energy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">opt</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">traj_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">copy</span><span class="p">()))</span>
<span class="n">opt</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">traj_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()))</span>

<span class="c1"># stop the optimization early to speed up the example</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>       Step     Time          Energy          fmax
LBFGS:    0 14:52:39     -756.134521        3.571309
LBFGS:    1 14:52:39     -758.695557        2.791725
LBFGS:    2 14:52:39     -759.814453        9.726065
LBFGS:    3 14:52:40     -762.155579        1.981837
LBFGS:    4 14:52:40     -762.748413        1.932890
LBFGS:    5 14:52:41     -763.676208        2.221198
LBFGS:    6 14:52:41     -764.275085        1.837465
LBFGS:    7 14:52:41     -765.156311        3.671942
LBFGS:    8 14:52:42     -765.424744        1.181422
LBFGS:    9 14:52:42     -765.619202        1.046649
LBFGS:   10 14:52:42     -766.063965        1.444247
LBFGS:   11 14:52:43     -766.304871        1.109455
LBFGS:   12 14:52:43     -766.739380        1.491510
LBFGS:   13 14:52:43     -766.981079        1.742025
LBFGS:   14 14:52:44     -767.375122        1.701664
LBFGS:   15 14:52:44     -767.819702        1.461260
LBFGS:   16 14:52:44     -768.149597        1.670303
LBFGS:   17 14:52:45     -768.566895        1.355899
LBFGS:   18 14:52:45     -769.125488        1.679093
LBFGS:   19 14:52:46     -769.680115        1.669340
LBFGS:   20 14:52:46     -770.123779        1.823724

np.False_
</pre></div>
</div>
<p>Even if the optimization is cut short and far from converged,
the decomposition of the oxygen molecules is apparent, and
leads to a large energetic stabilization</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">chemiscope</span><span class="o">.</span><span class="n">show</span><span class="p">(</span>
    <span class="n">structures</span><span class="o">=</span><span class="n">traj_atoms</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj_atoms</span><span class="p">)),</span>
        <span class="s2">&quot;energy&quot;</span><span class="p">:</span> <span class="n">traj_energy</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">settings</span><span class="o">=</span><span class="n">chemiscope</span><span class="o">.</span><span class="n">quick_settings</span><span class="p">(</span><span class="n">trajectory</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>


<!-- Error display -->
<div id="chsp-4e9e4ec2-50f0-4993-b723-6bea373ad8ef-error-display" class="chemiscope-sphinx-error">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-4e9e4ec2-50f0-4993-b723-6bea373ad8ef-error-display')">
        &times;
    </button>
</div>

<!-- Warning Display -->
<div id="chsp-4e9e4ec2-50f0-4993-b723-6bea373ad8ef-warning-display" class="chemiscope-sphinx-warning">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-4e9e4ec2-50f0-4993-b723-6bea373ad8ef-warning-display')">
        &times;
    </button>
</div>
<div style="padding: 0.5rem 1.25rem" />

<!-- Loading Spinner -->
<div id="chsp-4e9e4ec2-50f0-4993-b723-6bea373ad8ef-loading" class="chemiscope-sphinx-spinner">
    <img src="../../_static/chemiscope-loading.svg" alt="Loading icon" />
</div>

<!-- Chemiscope Visualization -->
<div id="chsp-4e9e4ec2-50f0-4993-b723-6bea373ad8ef">
    <!-- This will be replaced by the chemiscope HTML -->
</div>

<!-- Load Visualization Script -->
<script>
    loadChemiscopeSphinx('chsp-4e9e4ec2-50f0-4993-b723-6bea373ad8ef', '../../_datasets/140fbb34002abb8c0e1936e528019b1e7c4c8b36110c6ebde9be26d2b4669b42-fig_pet-mad_003.json.gz', 'default', '2000.0');
</script>
<div class="output_subarea output_html rendered_html output_result">

</div>
<br />
<br /></section>
<section id="molecular-dynamics-with-atoms-exchange-with-i-pi">
<h3>Molecular dynamics with atoms exchange with <code class="docutils literal notranslate"><span class="pre">i-PI</span></code><a class="headerlink" href="#molecular-dynamics-with-atoms-exchange-with-i-pi" title="Link to this heading">¶</a></h3>
<p>The geometry optimization shows the high reactivity of
this surface, but does not properly account for finite
temperature and does not sample the diffusion of solute
atoms in the alloy (which is mediated by vacancies).</p>
<p>We use <a class="reference external" href="http://ipi-code.org">i-PI</a> to perform a
molecular dynamics trajectory at 800K, combined with
Monte Carlo steps that swap the nature of atoms, allowing the simulation
to reach equilibrium in the solute-atoms distributions
without having to introduce vacancies or wait for the
very long time scale needed for diffusion.</p>
<p>The behavior of i-PI is controlled by an XML input file.
The <code class="docutils literal notranslate"><span class="pre">utils.scripting</span></code> module contains several helper
functions to generate the basic components.</p>
<p>Here we use a <code class="docutils literal notranslate"><span class="pre">&lt;motion</span> <span class="pre">mode=&quot;multi&quot;&gt;</span></code> block to combine
a MD run with a <code class="docutils literal notranslate"><span class="pre">&lt;motion</span> <span class="pre">mode=&quot;atomswap&quot;&gt;</span></code> block that
attempts swapping atoms, with a Monte Carlo acceptance.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">motion_xml</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;motion mode=&quot;multi&quot;&gt;</span>
<span class="s2">    </span><span class="si">{</span><span class="n">motion_nvt_xml</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ase</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    &lt;motion mode=&quot;atomswap&quot;&gt;</span>
<span class="s2">        &lt;atomswap&gt;</span>
<span class="s2">            &lt;nxc&gt; 0.1 &lt;/nxc&gt;</span>
<span class="s2">            &lt;names&gt; [ Al, Si, Mg, O]  &lt;/names&gt;</span>
<span class="s2">        &lt;/atomswap&gt;</span>
<span class="s2">    &lt;/motion&gt;</span>
<span class="s2">&lt;/motion&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">input_xml</span> <span class="o">=</span> <span class="n">simulation_xml</span><span class="p">(</span>
    <span class="n">structures</span><span class="o">=</span><span class="p">[</span><span class="n">al_surface</span><span class="p">],</span>
    <span class="n">forcefield</span><span class="o">=</span><span class="n">forcefield_xml</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pet-mad&quot;</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;direct&quot;</span><span class="p">,</span>
        <span class="n">pes</span><span class="o">=</span><span class="s2">&quot;metatomic&quot;</span><span class="p">,</span>
        <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;pet-mad-v1.0.2.pt&quot;</span><span class="p">,</span> <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;data/al6xxx-o2.xyz&quot;</span><span class="p">},</span>
    <span class="p">),</span>
    <span class="n">motion</span><span class="o">=</span><span class="n">motion_xml</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;nvt_atomxc&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">input_xml</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;simulation verbosity=&#39;high&#39; safe_stride=&#39;20&#39;&gt;

&lt;ffdirect name=&#39;pet-mad&#39;&gt;
&lt;pes&gt;metatomic&lt;/pes&gt;
&lt;parameters&gt;{model: pet-mad-v1.0.2.pt, template: data/al6xxx-o2.xyz}&lt;/parameters&gt;
&lt;/ffdirect&gt;


  &lt;output prefix=&#39;nvt_atomxc&#39;&gt;
    &lt;properties stride=&#39;2&#39; filename=&#39;out&#39;&gt;[ step, time{picosecond}, conserved{electronvolt}, temperature{kelvin}, potential{electronvolt} ]&lt;/properties&gt;
    &lt;trajectory filename=&#39;pos&#39; stride=&#39;20&#39; cell_units=&#39;angstrom&#39;&gt;positions{angstrom}&lt;/trajectory&gt;
    &lt;checkpoint stride=&#39;200&#39;&gt;
    &lt;/checkpoint&gt;
  &lt;/output&gt;
&lt;system&gt;
&lt;beads natoms=&#39;191&#39; nbeads=&#39;1&#39;&gt;
   &lt;q shape=&#39;(1, 573)&#39;&gt;
    [   0.00000000e+00,   0.00000000e+00,   2.77346357e+01,   5.41176453e+00,   0.00000000e+00,
        2.77346357e+01,   1.08235291e+01,   0.00000000e+00,   2.77346357e+01,   1.62352936e+01,
        0.00000000e+00,   2.77346357e+01,   2.16470582e+01,   0.00000000e+00,   2.77346357e+01,
        2.70588227e+00,   4.68672556e+00,   2.77346357e+01,   8.11764682e+00,   4.68672556e+00,
        2.77346357e+01,   1.35294114e+01,   4.68672556e+00,   2.77346357e+01,   1.89411759e+01,
        4.68672556e+00,   2.77346357e+01,   2.43529404e+01,   4.68672556e+00,   2.77346357e+01,
        5.41176453e+00,   9.37345114e+00,   2.77346357e+01,   1.08235291e+01,   9.37345114e+00,
        2.77346357e+01,   1.62352936e+01,   9.37345114e+00,   2.77346357e+01,   2.16470582e+01,
        9.37345114e+00,   2.77346357e+01,   2.70588227e+01,   9.37345114e+00,   2.77346357e+01,
        8.11764682e+00,   1.40601767e+01,   2.77346357e+01,   1.35294114e+01,   1.40601767e+01,
        2.77346357e+01,   1.89411759e+01,   1.40601767e+01,   2.77346357e+01,   2.43529404e+01,
        1.40601767e+01,   2.77346357e+01,   2.97647050e+01,   1.40601767e+01,   2.77346357e+01,
        1.08235291e+01,   1.87469023e+01,   2.77346357e+01,   1.62352936e+01,   1.87469023e+01,
        2.77346357e+01,   2.16470582e+01,   1.87469023e+01,   2.77346357e+01,   2.70588227e+01,
        1.87469023e+01,   2.77346357e+01,   3.24705872e+01,   1.87469023e+01,   2.77346357e+01,
        2.70588227e+00,   1.56224186e+00,   3.21533230e+01,   8.11764682e+00,   1.56224186e+00,
        3.21533230e+01,   1.35294114e+01,   1.56224186e+00,   3.21533230e+01,   1.89411759e+01,
        1.56224186e+00,   3.21533230e+01,   2.43529404e+01,   1.56224186e+00,   3.21533230e+01,
        5.41176453e+00,   6.24896742e+00,   3.21533230e+01,   1.08235291e+01,   6.24896742e+00,
        3.21533230e+01,   1.62352936e+01,   6.24896742e+00,   3.21533230e+01,   2.16470582e+01,
        6.24896742e+00,   3.21533230e+01,   2.70588227e+01,   6.24896742e+00,   3.21533230e+01,
        8.11764682e+00,   1.09356930e+01,   3.21533230e+01,   1.35294114e+01,   1.09356930e+01,
        3.21533230e+01,   1.89411759e+01,   1.09356930e+01,   3.21533230e+01,   2.43529404e+01,
        1.09356930e+01,   3.21533230e+01,   2.97647050e+01,   1.09356930e+01,   3.21533230e+01,
        1.08235291e+01,   1.56224186e+01,   3.21533230e+01,   1.62352936e+01,   1.56224186e+01,
        3.21533230e+01,   2.16470582e+01,   1.56224186e+01,   3.21533230e+01,   2.70588227e+01,
        1.56224186e+01,   3.21533230e+01,   3.24705872e+01,   1.56224186e+01,   3.21533230e+01,
        1.35294114e+01,   2.03091441e+01,   3.21533230e+01,   1.89411759e+01,   2.03091441e+01,
        3.21533230e+01,   2.43529404e+01,   2.03091441e+01,   3.21533230e+01,   2.97647050e+01,
        2.03091441e+01,   3.21533230e+01,   3.51764695e+01,   2.03091441e+01,   3.21533230e+01,
       -0.00000000e+00,   3.12448372e+00,   3.65720102e+01,   5.41176453e+00,   3.12448372e+00,
        3.65720102e+01,   1.08235291e+01,   3.12448372e+00,   3.65720102e+01,   1.62352936e+01,
        3.12448372e+00,   3.65720102e+01,   2.16470582e+01,   3.12448372e+00,   3.65720102e+01,
        2.70588227e+00,   7.81120928e+00,   3.65720102e+01,   8.11764682e+00,   7.81120928e+00,
        3.65720102e+01,   1.35294114e+01,   7.81120928e+00,   3.65720102e+01,   1.89411759e+01,
        7.81120928e+00,   3.65720102e+01,   2.43529404e+01,   7.81120928e+00,   3.65720102e+01,
        5.41176453e+00,   1.24979349e+01,   3.65720102e+01,   1.08235291e+01,   1.24979349e+01,
        3.65720102e+01,   1.62352936e+01,   1.24979349e+01,   3.65720102e+01,   2.16470582e+01,
        1.24979349e+01,   3.65720102e+01,   2.70588227e+01,   1.24979349e+01,   3.65720102e+01,
        8.11764682e+00,   1.71846604e+01,   3.65720102e+01,   1.35294114e+01,   1.71846604e+01,
        3.65720102e+01,   1.89411759e+01,   1.71846604e+01,   3.65720102e+01,   2.43529404e+01,
        1.71846604e+01,   3.65720102e+01,   2.97647050e+01,   1.71846604e+01,   3.65720102e+01,
        1.08235291e+01,   2.18713860e+01,   3.65720102e+01,   1.62352936e+01,   2.18713860e+01,
        3.65720102e+01,   2.16470582e+01,   2.18713860e+01,   3.65720102e+01,   2.70588227e+01,
        2.18713860e+01,   3.65720102e+01,   3.24705872e+01,   2.18713860e+01,   3.65720102e+01,
        0.00000000e+00,   0.00000000e+00,   4.09906975e+01,   5.41176453e+00,   0.00000000e+00,
        4.09906975e+01,   1.08235291e+01,   0.00000000e+00,   4.09906975e+01,   1.62352936e+01,
        0.00000000e+00,   4.09906975e+01,   2.16470582e+01,   0.00000000e+00,   4.09906975e+01,
        2.70588227e+00,   4.68672556e+00,   4.09906975e+01,   8.11764682e+00,   4.68672556e+00,
        4.09906975e+01,   1.35294114e+01,   4.68672556e+00,   4.09906975e+01,   1.89411759e+01,
        4.68672556e+00,   4.09906975e+01,   2.43529404e+01,   4.68672556e+00,   4.09906975e+01,
        5.41176453e+00,   9.37345114e+00,   4.09906975e+01,   1.08235291e+01,   9.37345114e+00,
        4.09906975e+01,   1.62352936e+01,   9.37345114e+00,   4.09906975e+01,   2.16470582e+01,
        9.37345114e+00,   4.09906975e+01,   2.70588227e+01,   9.37345114e+00,   4.09906975e+01,
        8.11764682e+00,   1.40601767e+01,   4.09906975e+01,   1.35294114e+01,   1.40601767e+01,
        4.09906975e+01,   1.89411759e+01,   1.40601767e+01,   4.09906975e+01,   2.43529404e+01,
        1.40601767e+01,   4.09906975e+01,   2.97647050e+01,   1.40601767e+01,   4.09906975e+01,
        1.08235291e+01,   1.87469023e+01,   4.09906975e+01,   1.62352936e+01,   1.87469023e+01,
        4.09906975e+01,   2.16470582e+01,   1.87469023e+01,   4.09906975e+01,   2.70588227e+01,
        1.87469023e+01,   4.09906975e+01,   3.24705872e+01,   1.87469023e+01,   4.09906975e+01,
        2.70588227e+00,   1.56224186e+00,   4.54093847e+01,   8.11764682e+00,   1.56224186e+00,
        4.54093847e+01,   1.35294114e+01,   1.56224186e+00,   4.54093847e+01,   1.89411759e+01,
        1.56224186e+00,   4.54093847e+01,   2.43529404e+01,   1.56224186e+00,   4.54093847e+01,
        5.41176453e+00,   6.24896742e+00,   4.54093847e+01,   1.08235291e+01,   6.24896742e+00,
        4.54093847e+01,   1.62352936e+01,   6.24896742e+00,   4.54093847e+01,   2.16470582e+01,
        6.24896742e+00,   4.54093847e+01,   2.70588227e+01,   6.24896742e+00,   4.54093847e+01,
        8.11764682e+00,   1.09356930e+01,   4.54093847e+01,   1.35294114e+01,   1.09356930e+01,
        4.54093847e+01,   1.89411759e+01,   1.09356930e+01,   4.54093847e+01,   2.43529404e+01,
        1.09356930e+01,   4.54093847e+01,   2.97647050e+01,   1.09356930e+01,   4.54093847e+01,
        1.08235291e+01,   1.56224186e+01,   4.54093847e+01,   1.62352936e+01,   1.56224186e+01,
        4.54093847e+01,   2.16470582e+01,   1.56224186e+01,   4.54093847e+01,   2.70588227e+01,
        1.56224186e+01,   4.54093847e+01,   3.24705872e+01,   1.56224186e+01,   4.54093847e+01,
        1.35294114e+01,   2.03091441e+01,   4.54093847e+01,   1.89411759e+01,   2.03091441e+01,
        4.54093847e+01,   2.43529404e+01,   2.03091441e+01,   4.54093847e+01,   2.97647050e+01,
        2.03091441e+01,   4.54093847e+01,   3.51764695e+01,   2.03091441e+01,   4.54093847e+01,
       -0.00000000e+00,   3.12448372e+00,   4.98280720e+01,   5.41176453e+00,   3.12448372e+00,
        4.98280720e+01,   1.08235291e+01,   3.12448372e+00,   4.98280720e+01,   1.62352936e+01,
        3.12448372e+00,   4.98280720e+01,   2.16470582e+01,   3.12448372e+00,   4.98280720e+01,
        2.70588227e+00,   7.81120928e+00,   4.98280720e+01,   8.11764682e+00,   7.81120928e+00,
        4.98280720e+01,   1.35294114e+01,   7.81120928e+00,   4.98280720e+01,   1.89411759e+01,
        7.81120928e+00,   4.98280720e+01,   2.43529404e+01,   7.81120928e+00,   4.98280720e+01,
        5.41176453e+00,   1.24979349e+01,   4.98280720e+01,   1.08235291e+01,   1.24979349e+01,
        4.98280720e+01,   1.62352936e+01,   1.24979349e+01,   4.98280720e+01,   2.16470582e+01,
        1.24979349e+01,   4.98280720e+01,   2.70588227e+01,   1.24979349e+01,   4.98280720e+01,
        8.11764682e+00,   1.71846604e+01,   4.98280720e+01,   1.35294114e+01,   1.71846604e+01,
        4.98280720e+01,   1.89411759e+01,   1.71846604e+01,   4.98280720e+01,   2.43529404e+01,
        1.71846604e+01,   4.98280720e+01,   2.97647050e+01,   1.71846604e+01,   4.98280720e+01,
        1.08235291e+01,   2.18713860e+01,   4.98280720e+01,   1.62352936e+01,   2.18713860e+01,
        4.98280720e+01,   2.16470582e+01,   2.18713860e+01,   4.98280720e+01,   2.70588227e+01,
        2.18713860e+01,   4.98280720e+01,   3.24705872e+01,   2.18713860e+01,   4.98280720e+01,
        0.00000000e+00,   0.00000000e+00,   5.42467592e+01,   5.41176453e+00,   0.00000000e+00,
        5.42467592e+01,   1.08235291e+01,   0.00000000e+00,   5.42467592e+01,   1.62352936e+01,
        0.00000000e+00,   5.42467592e+01,   2.16470582e+01,   0.00000000e+00,   5.42467592e+01,
        2.70588227e+00,   4.68672556e+00,   5.42467592e+01,   8.11764682e+00,   4.68672556e+00,
        5.42467592e+01,   1.35294114e+01,   4.68672556e+00,   5.42467592e+01,   1.89411759e+01,
        4.68672556e+00,   5.42467592e+01,   2.43529404e+01,   4.68672556e+00,   5.42467592e+01,
        5.41176453e+00,   9.37345114e+00,   5.42467592e+01,   1.08235291e+01,   9.37345114e+00,
        5.42467592e+01,   1.62352936e+01,   9.37345114e+00,   5.42467592e+01,   2.16470582e+01,
        9.37345114e+00,   5.42467592e+01,   2.70588227e+01,   9.37345114e+00,   5.42467592e+01,
        8.11764682e+00,   1.40601767e+01,   5.42467592e+01,   1.35294114e+01,   1.40601767e+01,
        5.42467592e+01,   1.89411759e+01,   1.40601767e+01,   5.42467592e+01,   2.43529404e+01,
        1.40601767e+01,   5.42467592e+01,   2.97647050e+01,   1.40601767e+01,   5.42467592e+01,
        1.08235291e+01,   1.87469023e+01,   5.42467592e+01,   1.62352936e+01,   1.87469023e+01,
        5.42467592e+01,   2.16470582e+01,   1.87469023e+01,   5.42467592e+01,   2.70588227e+01,
        1.87469023e+01,   5.42467592e+01,   3.24705872e+01,   1.87469023e+01,   5.42467592e+01,
        0.00000000e+00,   0.00000000e+00,   5.80262115e+01,  -3.02356180e+00,   0.00000000e+00,
        5.80262115e+01,   9.44863063e+00,   0.00000000e+00,   5.80262115e+01,   6.42506883e+00,
        0.00000000e+00,   5.80262115e+01,   1.88972613e+01,   0.00000000e+00,   5.80262115e+01,
        1.58736995e+01,   0.00000000e+00,   5.80262115e+01,   9.44863063e+00,   9.44863063e+00,
        5.80262115e+01,   6.42506883e+00,   9.44863063e+00,   5.80262115e+01,   1.88972613e+01,
        9.44863063e+00,   5.80262115e+01,   1.58736995e+01,   9.44863063e+00,   5.80262115e+01,
        2.83458919e+01,   9.44863063e+00,   5.80262115e+01,   2.53223301e+01,   9.44863063e+00,
        5.80262115e+01,   1.88972613e+01,   1.88972613e+01,   5.80262115e+01,   1.58736995e+01,
        1.88972613e+01,   5.80262115e+01,   2.83458919e+01,   1.88972613e+01,   5.80262115e+01,
        2.53223301e+01,   1.88972613e+01,   5.80262115e+01 ]
   &lt;/q&gt;
   &lt;p shape=&#39;(1, 573)&#39;&gt;
    [   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00 ]
   &lt;/p&gt;
   &lt;m shape=&#39;(191)&#39;&gt;
    [   4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   5.11967350e+04,   4.91843353e+04,   4.43053050e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   5.11967350e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.43053050e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        5.11967350e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        5.11967350e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.43053050e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.43053050e+04,   5.11967350e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   5.11967350e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   5.11967350e+04,
        2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,
        2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,
        2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,
        2.91651223e+04 ]
   &lt;/m&gt;
   &lt;names shape=&#39;(191)&#39;&gt;
    [ Mg, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Si, Al, Mg, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Si,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Mg, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Mg, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Si, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Si, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Mg, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Mg, Si, Al, Al, Al,
      Al, Al, Al, Al, Si,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Mg, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Mg, Al, Al, Al, Si,
      O, O, O, O, O,
      O, O, O, O, O,
      O, O, O, O, O,
      O ]
   &lt;/names&gt;
&lt;/beads&gt;

&lt;cell shape=&#39;(3, 3)&#39;&gt;
 [   2.70588227e+01,   1.35294114e+01,   0.00000000e+00,   0.00000000e+00,   2.34336279e+01,
     0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   7.31440205e+01 ]
&lt;/cell&gt;

&lt;initialize nbeads=&#39;1&#39;&gt;&lt;velocities mode=&#39;thermal&#39; units=&#39;ase&#39;&gt; 800 &lt;/velocities&gt;&lt;/initialize&gt;&lt;ensemble&gt;&lt;temperature units=&#39;ase&#39;&gt; 800 &lt;/temperature&gt;&lt;/ensemble&gt;
&lt;forces&gt;
&lt;force forcefield=&#39;pet-mad&#39;&gt; &lt;/force&gt;
&lt;/forces&gt;

&lt;motion mode=&quot;multi&quot;&gt;

&lt;motion mode=&quot;dynamics&quot;&gt;
&lt;dynamics mode=&quot;nvt&quot;&gt;
&lt;timestep units=&quot;ase&quot;&gt; 0.4911347394232032 &lt;/timestep&gt;

&lt;thermostat mode=&#39;svr&#39;&gt;
    &lt;tau units=&#39;ase&#39;&gt; 4.911347394232032 &lt;/tau&gt;
&lt;/thermostat&gt;

&lt;/dynamics&gt;
&lt;/motion&gt;

    &lt;motion mode=&quot;atomswap&quot;&gt;
        &lt;atomswap&gt;
            &lt;nxc&gt; 0.1 &lt;/nxc&gt;
            &lt;names&gt; [ Al, Si, Mg, O]  &lt;/names&gt;
        &lt;/atomswap&gt;
    &lt;/motion&gt;
&lt;/motion&gt;

&lt;/system&gt;
&lt;/simulation&gt;
</pre></div>
</div>
<p>The simulation can be run from a Python script or the command line. By changing the
forcefield interface from <code class="docutils literal notranslate"><span class="pre">direct</span></code> to the use of a socket, it is also possible to
execute separately <code class="docutils literal notranslate"><span class="pre">i-PI</span></code> and the <code class="docutils literal notranslate"><span class="pre">metatomic</span></code> driver.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">InteractiveSimulation</span><span class="p">(</span><span class="n">input_xml</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> @system: Initializing system object
 @simulation: Initializing simulation object
@ RANDOM SEED: The seed used in this calculation was 1771858366805
 @initializer: Initializer (stage 1) parsing velocities object.
 !W! Overwriting previous atomic momenta
 @initializer: Resampling velocities at temperature 800.0 ase
 --- begin input file content ---

  &lt;simulation verbosity=&#39;high&#39; safe_stride=&#39;20&#39;&gt;
    &lt;ffdirect name=&#39;pet-mad&#39;&gt;
      &lt;pes&gt;metatomic&lt;/pes&gt;
      &lt;parameters&gt;{model: pet-mad-v1.0.2.pt, template: data/al6xxx-o2.xyz}&lt;/parameters&gt;
    &lt;/ffdirect&gt;
    &lt;output prefix=&#39;nvt_atomxc&#39;&gt;
      &lt;properties stride=&#39;2&#39; filename=&#39;out&#39;&gt;[ step, time{picosecond}, conserved{electronvolt}, temperature{kelvin}, potential{electronvolt} ]&lt;/properties&gt;
      &lt;trajectory filename=&#39;pos&#39; stride=&#39;20&#39; cell_units=&#39;angstrom&#39;&gt;positions{angstrom}&lt;/trajectory&gt;
      &lt;checkpoint stride=&#39;200&#39;&gt;
      &lt;/checkpoint&gt;
    &lt;/output&gt;
    &lt;system&gt;
      &lt;beads natoms=&#39;191&#39; nbeads=&#39;1&#39;&gt;
        &lt;q shape=&#39;(1, 573)&#39;&gt;[   0.00000000e+00,   0.00000000e+00,   2.77346357e+01,   5.41176453e+00,   0.00000000e+00,
        2.77346357e+01,   1.08235291e+01,   0.00000000e+00,   2.77346357e+01,   1.62352936e+01,
        0.00000000e+00,   2.77346357e+01,   2.16470582e+01,   0.00000000e+00,   2.77346357e+01,
        2.70588227e+00,   4.68672556e+00,   2.77346357e+01,   8.11764682e+00,   4.68672556e+00,
        2.77346357e+01,   1.35294114e+01,   4.68672556e+00,   2.77346357e+01,   1.89411759e+01,
        4.68672556e+00,   2.77346357e+01,   2.43529404e+01,   4.68672556e+00,   2.77346357e+01,
        5.41176453e+00,   9.37345114e+00,   2.77346357e+01,   1.08235291e+01,   9.37345114e+00,
        2.77346357e+01,   1.62352936e+01,   9.37345114e+00,   2.77346357e+01,   2.16470582e+01,
        9.37345114e+00,   2.77346357e+01,   2.70588227e+01,   9.37345114e+00,   2.77346357e+01,
        8.11764682e+00,   1.40601767e+01,   2.77346357e+01,   1.35294114e+01,   1.40601767e+01,
        2.77346357e+01,   1.89411759e+01,   1.40601767e+01,   2.77346357e+01,   2.43529404e+01,
        1.40601767e+01,   2.77346357e+01,   2.97647050e+01,   1.40601767e+01,   2.77346357e+01,
        1.08235291e+01,   1.87469023e+01,   2.77346357e+01,   1.62352936e+01,   1.87469023e+01,
        2.77346357e+01,   2.16470582e+01,   1.87469023e+01,   2.77346357e+01,   2.70588227e+01,
        1.87469023e+01,   2.77346357e+01,   3.24705872e+01,   1.87469023e+01,   2.77346357e+01,
        2.70588227e+00,   1.56224186e+00,   3.21533230e+01,   8.11764682e+00,   1.56224186e+00,
        3.21533230e+01,   1.35294114e+01,   1.56224186e+00,   3.21533230e+01,   1.89411759e+01,
        1.56224186e+00,   3.21533230e+01,   2.43529404e+01,   1.56224186e+00,   3.21533230e+01,
        5.41176453e+00,   6.24896742e+00,   3.21533230e+01,   1.08235291e+01,   6.24896742e+00,
        3.21533230e+01,   1.62352936e+01,   6.24896742e+00,   3.21533230e+01,   2.16470582e+01,
        6.24896742e+00,   3.21533230e+01,   2.70588227e+01,   6.24896742e+00,   3.21533230e+01,
        8.11764682e+00,   1.09356930e+01,   3.21533230e+01,   1.35294114e+01,   1.09356930e+01,
        3.21533230e+01,   1.89411759e+01,   1.09356930e+01,   3.21533230e+01,   2.43529404e+01,
        1.09356930e+01,   3.21533230e+01,   2.97647050e+01,   1.09356930e+01,   3.21533230e+01,
        1.08235291e+01,   1.56224186e+01,   3.21533230e+01,   1.62352936e+01,   1.56224186e+01,
        3.21533230e+01,   2.16470582e+01,   1.56224186e+01,   3.21533230e+01,   2.70588227e+01,
        1.56224186e+01,   3.21533230e+01,   3.24705872e+01,   1.56224186e+01,   3.21533230e+01,
        1.35294114e+01,   2.03091441e+01,   3.21533230e+01,   1.89411759e+01,   2.03091441e+01,
        3.21533230e+01,   2.43529404e+01,   2.03091441e+01,   3.21533230e+01,   2.97647050e+01,
        2.03091441e+01,   3.21533230e+01,   3.51764695e+01,   2.03091441e+01,   3.21533230e+01,
       -0.00000000e+00,   3.12448372e+00,   3.65720102e+01,   5.41176453e+00,   3.12448372e+00,
        3.65720102e+01,   1.08235291e+01,   3.12448372e+00,   3.65720102e+01,   1.62352936e+01,
        3.12448372e+00,   3.65720102e+01,   2.16470582e+01,   3.12448372e+00,   3.65720102e+01,
        2.70588227e+00,   7.81120928e+00,   3.65720102e+01,   8.11764682e+00,   7.81120928e+00,
        3.65720102e+01,   1.35294114e+01,   7.81120928e+00,   3.65720102e+01,   1.89411759e+01,
        7.81120928e+00,   3.65720102e+01,   2.43529404e+01,   7.81120928e+00,   3.65720102e+01,
        5.41176453e+00,   1.24979349e+01,   3.65720102e+01,   1.08235291e+01,   1.24979349e+01,
        3.65720102e+01,   1.62352936e+01,   1.24979349e+01,   3.65720102e+01,   2.16470582e+01,
        1.24979349e+01,   3.65720102e+01,   2.70588227e+01,   1.24979349e+01,   3.65720102e+01,
        8.11764682e+00,   1.71846604e+01,   3.65720102e+01,   1.35294114e+01,   1.71846604e+01,
        3.65720102e+01,   1.89411759e+01,   1.71846604e+01,   3.65720102e+01,   2.43529404e+01,
        1.71846604e+01,   3.65720102e+01,   2.97647050e+01,   1.71846604e+01,   3.65720102e+01,
        1.08235291e+01,   2.18713860e+01,   3.65720102e+01,   1.62352936e+01,   2.18713860e+01,
        3.65720102e+01,   2.16470582e+01,   2.18713860e+01,   3.65720102e+01,   2.70588227e+01,
        2.18713860e+01,   3.65720102e+01,   3.24705872e+01,   2.18713860e+01,   3.65720102e+01,
        0.00000000e+00,   0.00000000e+00,   4.09906975e+01,   5.41176453e+00,   0.00000000e+00,
        4.09906975e+01,   1.08235291e+01,   0.00000000e+00,   4.09906975e+01,   1.62352936e+01,
        0.00000000e+00,   4.09906975e+01,   2.16470582e+01,   0.00000000e+00,   4.09906975e+01,
        2.70588227e+00,   4.68672556e+00,   4.09906975e+01,   8.11764682e+00,   4.68672556e+00,
        4.09906975e+01,   1.35294114e+01,   4.68672556e+00,   4.09906975e+01,   1.89411759e+01,
        4.68672556e+00,   4.09906975e+01,   2.43529404e+01,   4.68672556e+00,   4.09906975e+01,
        5.41176453e+00,   9.37345114e+00,   4.09906975e+01,   1.08235291e+01,   9.37345114e+00,
        4.09906975e+01,   1.62352936e+01,   9.37345114e+00,   4.09906975e+01,   2.16470582e+01,
        9.37345114e+00,   4.09906975e+01,   2.70588227e+01,   9.37345114e+00,   4.09906975e+01,
        8.11764682e+00,   1.40601767e+01,   4.09906975e+01,   1.35294114e+01,   1.40601767e+01,
        4.09906975e+01,   1.89411759e+01,   1.40601767e+01,   4.09906975e+01,   2.43529404e+01,
        1.40601767e+01,   4.09906975e+01,   2.97647050e+01,   1.40601767e+01,   4.09906975e+01,
        1.08235291e+01,   1.87469023e+01,   4.09906975e+01,   1.62352936e+01,   1.87469023e+01,
        4.09906975e+01,   2.16470582e+01,   1.87469023e+01,   4.09906975e+01,   2.70588227e+01,
        1.87469023e+01,   4.09906975e+01,   3.24705872e+01,   1.87469023e+01,   4.09906975e+01,
        2.70588227e+00,   1.56224186e+00,   4.54093847e+01,   8.11764682e+00,   1.56224186e+00,
        4.54093847e+01,   1.35294114e+01,   1.56224186e+00,   4.54093847e+01,   1.89411759e+01,
        1.56224186e+00,   4.54093847e+01,   2.43529404e+01,   1.56224186e+00,   4.54093847e+01,
        5.41176453e+00,   6.24896742e+00,   4.54093847e+01,   1.08235291e+01,   6.24896742e+00,
        4.54093847e+01,   1.62352936e+01,   6.24896742e+00,   4.54093847e+01,   2.16470582e+01,
        6.24896742e+00,   4.54093847e+01,   2.70588227e+01,   6.24896742e+00,   4.54093847e+01,
        8.11764682e+00,   1.09356930e+01,   4.54093847e+01,   1.35294114e+01,   1.09356930e+01,
        4.54093847e+01,   1.89411759e+01,   1.09356930e+01,   4.54093847e+01,   2.43529404e+01,
        1.09356930e+01,   4.54093847e+01,   2.97647050e+01,   1.09356930e+01,   4.54093847e+01,
        1.08235291e+01,   1.56224186e+01,   4.54093847e+01,   1.62352936e+01,   1.56224186e+01,
        4.54093847e+01,   2.16470582e+01,   1.56224186e+01,   4.54093847e+01,   2.70588227e+01,
        1.56224186e+01,   4.54093847e+01,   3.24705872e+01,   1.56224186e+01,   4.54093847e+01,
        1.35294114e+01,   2.03091441e+01,   4.54093847e+01,   1.89411759e+01,   2.03091441e+01,
        4.54093847e+01,   2.43529404e+01,   2.03091441e+01,   4.54093847e+01,   2.97647050e+01,
        2.03091441e+01,   4.54093847e+01,   3.51764695e+01,   2.03091441e+01,   4.54093847e+01,
       -0.00000000e+00,   3.12448372e+00,   4.98280720e+01,   5.41176453e+00,   3.12448372e+00,
        4.98280720e+01,   1.08235291e+01,   3.12448372e+00,   4.98280720e+01,   1.62352936e+01,
        3.12448372e+00,   4.98280720e+01,   2.16470582e+01,   3.12448372e+00,   4.98280720e+01,
        2.70588227e+00,   7.81120928e+00,   4.98280720e+01,   8.11764682e+00,   7.81120928e+00,
        4.98280720e+01,   1.35294114e+01,   7.81120928e+00,   4.98280720e+01,   1.89411759e+01,
        7.81120928e+00,   4.98280720e+01,   2.43529404e+01,   7.81120928e+00,   4.98280720e+01,
        5.41176453e+00,   1.24979349e+01,   4.98280720e+01,   1.08235291e+01,   1.24979349e+01,
        4.98280720e+01,   1.62352936e+01,   1.24979349e+01,   4.98280720e+01,   2.16470582e+01,
        1.24979349e+01,   4.98280720e+01,   2.70588227e+01,   1.24979349e+01,   4.98280720e+01,
        8.11764682e+00,   1.71846604e+01,   4.98280720e+01,   1.35294114e+01,   1.71846604e+01,
        4.98280720e+01,   1.89411759e+01,   1.71846604e+01,   4.98280720e+01,   2.43529404e+01,
        1.71846604e+01,   4.98280720e+01,   2.97647050e+01,   1.71846604e+01,   4.98280720e+01,
        1.08235291e+01,   2.18713860e+01,   4.98280720e+01,   1.62352936e+01,   2.18713860e+01,
        4.98280720e+01,   2.16470582e+01,   2.18713860e+01,   4.98280720e+01,   2.70588227e+01,
        2.18713860e+01,   4.98280720e+01,   3.24705872e+01,   2.18713860e+01,   4.98280720e+01,
        0.00000000e+00,   0.00000000e+00,   5.42467592e+01,   5.41176453e+00,   0.00000000e+00,
        5.42467592e+01,   1.08235291e+01,   0.00000000e+00,   5.42467592e+01,   1.62352936e+01,
        0.00000000e+00,   5.42467592e+01,   2.16470582e+01,   0.00000000e+00,   5.42467592e+01,
        2.70588227e+00,   4.68672556e+00,   5.42467592e+01,   8.11764682e+00,   4.68672556e+00,
        5.42467592e+01,   1.35294114e+01,   4.68672556e+00,   5.42467592e+01,   1.89411759e+01,
        4.68672556e+00,   5.42467592e+01,   2.43529404e+01,   4.68672556e+00,   5.42467592e+01,
        5.41176453e+00,   9.37345114e+00,   5.42467592e+01,   1.08235291e+01,   9.37345114e+00,
        5.42467592e+01,   1.62352936e+01,   9.37345114e+00,   5.42467592e+01,   2.16470582e+01,
        9.37345114e+00,   5.42467592e+01,   2.70588227e+01,   9.37345114e+00,   5.42467592e+01,
        8.11764682e+00,   1.40601767e+01,   5.42467592e+01,   1.35294114e+01,   1.40601767e+01,
        5.42467592e+01,   1.89411759e+01,   1.40601767e+01,   5.42467592e+01,   2.43529404e+01,
        1.40601767e+01,   5.42467592e+01,   2.97647050e+01,   1.40601767e+01,   5.42467592e+01,
        1.08235291e+01,   1.87469023e+01,   5.42467592e+01,   1.62352936e+01,   1.87469023e+01,
        5.42467592e+01,   2.16470582e+01,   1.87469023e+01,   5.42467592e+01,   2.70588227e+01,
        1.87469023e+01,   5.42467592e+01,   3.24705872e+01,   1.87469023e+01,   5.42467592e+01,
        0.00000000e+00,   0.00000000e+00,   5.80262115e+01,  -3.02356180e+00,   0.00000000e+00,
        5.80262115e+01,   9.44863063e+00,   0.00000000e+00,   5.80262115e+01,   6.42506883e+00,
        0.00000000e+00,   5.80262115e+01,   1.88972613e+01,   0.00000000e+00,   5.80262115e+01,
        1.58736995e+01,   0.00000000e+00,   5.80262115e+01,   9.44863063e+00,   9.44863063e+00,
        5.80262115e+01,   6.42506883e+00,   9.44863063e+00,   5.80262115e+01,   1.88972613e+01,
        9.44863063e+00,   5.80262115e+01,   1.58736995e+01,   9.44863063e+00,   5.80262115e+01,
        2.83458919e+01,   9.44863063e+00,   5.80262115e+01,   2.53223301e+01,   9.44863063e+00,
        5.80262115e+01,   1.88972613e+01,   1.88972613e+01,   5.80262115e+01,   1.58736995e+01,
        1.88972613e+01,   5.80262115e+01,   2.83458919e+01,   1.88972613e+01,   5.80262115e+01,
        2.53223301e+01,   1.88972613e+01,   5.80262115e+01 ]&lt;/q&gt;
        &lt;p shape=&#39;(1, 573)&#39;&gt;[   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
        0.00000000e+00,   0.00000000e+00,   0.00000000e+00 ]&lt;/p&gt;
        &lt;m shape=&#39;(191)&#39;&gt;[   4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   5.11967350e+04,   4.91843353e+04,   4.43053050e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   5.11967350e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.43053050e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        5.11967350e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        5.11967350e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.43053050e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.43053050e+04,   5.11967350e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   5.11967350e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,
        4.43053050e+04,   4.91843353e+04,   4.91843353e+04,   4.91843353e+04,   5.11967350e+04,
        2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,
        2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,
        2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,   2.91651223e+04,
        2.91651223e+04 ]&lt;/m&gt;
        &lt;names shape=&#39;(191)&#39;&gt;[ Mg, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Si, Al, Mg, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Si,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Mg, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Mg, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Si, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Si, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Mg, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Mg, Si, Al, Al, Al,
      Al, Al, Al, Al, Si,
      Al, Al, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Al, Mg, Al, Al, Al,
      Al, Al, Al, Al, Al,
      Mg, Al, Al, Al, Si,
      O, O, O, O, O,
      O, O, O, O, O,
      O, O, O, O, O,
      O ]&lt;/names&gt;
      &lt;/beads&gt;
      &lt;cell shape=&#39;(3, 3)&#39;&gt;[   2.70588227e+01,   1.35294114e+01,   0.00000000e+00,   0.00000000e+00,   2.34336279e+01,
     0.00000000e+00,   0.00000000e+00,   0.00000000e+00,   7.31440205e+01 ]&lt;/cell&gt;
      &lt;initialize nbeads=&#39;1&#39;&gt;
        &lt;velocities mode=&#39;thermal&#39; units=&#39;ase&#39;&gt;800&lt;/velocities&gt;
      &lt;/initialize&gt;
      &lt;ensemble&gt;
        &lt;temperature units=&#39;ase&#39;&gt;800&lt;/temperature&gt;
      &lt;/ensemble&gt;
      &lt;forces&gt;
        &lt;force forcefield=&#39;pet-mad&#39;&gt;
        &lt;/force&gt;
      &lt;/forces&gt;
      &lt;motion mode=&#39;multi&#39;&gt;
        &lt;motion mode=&#39;dynamics&#39;&gt;
          &lt;dynamics mode=&#39;nvt&#39;&gt;
            &lt;timestep units=&#39;ase&#39;&gt;0.4911347394232032&lt;/timestep&gt;
            &lt;thermostat mode=&#39;svr&#39;&gt;
              &lt;tau units=&#39;ase&#39;&gt;4.911347394232032&lt;/tau&gt;
            &lt;/thermostat&gt;
          &lt;/dynamics&gt;
        &lt;/motion&gt;
        &lt;motion mode=&#39;atomswap&#39;&gt;
          &lt;atomswap&gt;
            &lt;nxc&gt;0.1&lt;/nxc&gt;
            &lt;names&gt;[ Al, Si, Mg, O]&lt;/names&gt;
          &lt;/atomswap&gt;
        &lt;/motion&gt;
      &lt;/motion&gt;
    &lt;/system&gt;
  &lt;/simulation&gt;
 ---  end input file content  ---
 @system.bind: Binding the forces
 @initializer: Initializer (stage 2) parsing velocities object.
 @simulation.run: Average timings at MD step       0. t/step: 1.32746e+00
 @simulation.run: Average timings at MD step       1. t/step: 6.19303e-01
 @simulation.run: Average timings at MD step       2. t/step: 3.61408e-01
 @simulation.run: Average timings at MD step       3. t/step: 4.04543e-01
 @simulation.run: Average timings at MD step       4. t/step: 3.58893e-01
 @simulation.run: Average timings at MD step       5. t/step: 4.18895e-01
 @simulation.run: Average timings at MD step       6. t/step: 3.59191e-01
 @simulation.run: Average timings at MD step       7. t/step: 4.73719e-01
 @simulation.run: Average timings at MD step       8. t/step: 3.76373e-01
 @simulation.run: Average timings at MD step       9. t/step: 4.31238e-01
 @simulation.run: Average timings at MD step      10. t/step: 3.78218e-01
 @simulation.run: Average timings at MD step      11. t/step: 4.27193e-01
 @simulation.run: Average timings at MD step      12. t/step: 3.93885e-01
 @simulation.run: Average timings at MD step      13. t/step: 4.98594e-01
 @simulation.run: Average timings at MD step      14. t/step: 4.15987e-01
 @simulation.run: Average timings at MD step      15. t/step: 5.22229e-01
 @simulation.run: Average timings at MD step      16. t/step: 4.03075e-01
 @simulation.run: Average timings at MD step      17. t/step: 4.30341e-01
 @simulation.run: Average timings at MD step      18. t/step: 3.98655e-01
 @simulation.run: Average timings at MD step      19. t/step: 4.49993e-01
 @simulation.run: Average timings at MD step      20. t/step: 4.07373e-01
 @simulation.run: Average timings at MD step      21. t/step: 4.29417e-01
 @simulation.run: Average timings at MD step      22. t/step: 4.05939e-01
 @simulation.run: Average timings at MD step      23. t/step: 4.55528e-01
 @simulation.run: Average timings at MD step      24. t/step: 4.12057e-01
 @simulation.run: Average timings at MD step      25. t/step: 4.44220e-01
 @simulation.run: Average timings at MD step      26. t/step: 4.38133e-01
 @simulation.run: Average timings at MD step      27. t/step: 5.22235e-01
 @simulation.run: Average timings at MD step      28. t/step: 4.55022e-01
 @simulation.run: Average timings at MD step      29. t/step: 4.68713e-01
 @simulation.run: Average timings at MD step      30. t/step: 4.01313e-01
 @simulation.run: Average timings at MD step      31. t/step: 8.79263e-01
 @simulation.run: Average timings at MD step      32. t/step: 4.01905e-01
 @simulation.run: Average timings at MD step      33. t/step: 4.67937e-01
 @simulation.run: Average timings at MD step      34. t/step: 4.39905e-01
 @simulation.run: Average timings at MD step      35. t/step: 1.35554e+00
 @simulation.run: Average timings at MD step      36. t/step: 4.48941e-01
 @simulation.run: Average timings at MD step      37. t/step: 5.03881e-01
 @simulation.run: Average timings at MD step      38. t/step: 4.01295e-01
 @simulation.run: Average timings at MD step      39. t/step: 4.87273e-01
 @simulation.run: Average timings at MD step      40. t/step: 3.93423e-01
 @simulation.run: Average timings at MD step      41. t/step: 4.92270e-01
 @simulation.run: Average timings at MD step      42. t/step: 8.68555e-01
 @simulation.run: Average timings at MD step      43. t/step: 5.20421e-01
 @simulation.run: Average timings at MD step      44. t/step: 4.07081e-01
 @simulation.run: Average timings at MD step      45. t/step: 8.87313e-01
 @simulation.run: Average timings at MD step      46. t/step: 4.05129e-01
 @simulation.run: Average timings at MD step      47. t/step: 5.12477e-01
 @simulation.run: Average timings at MD step      48. t/step: 4.16618e-01
 @simulation.run: Average timings at MD step      49. t/step: 4.90828e-01
 @simulation.run: Average timings at MD step      50. t/step: 3.96360e-01
 @simulation.run: Average timings at MD step      51. t/step: 4.27901e-01
 @simulation.run: Average timings at MD step      52. t/step: 3.91448e-01
 @simulation.run: Average timings at MD step      53. t/step: 4.26968e-01
 @simulation.run: Average timings at MD step      54. t/step: 3.96160e-01
 @simulation.run: Average timings at MD step      55. t/step: 4.52695e-01
 @simulation.run: Average timings at MD step      56. t/step: 3.98571e-01
 @simulation.run: Average timings at MD step      57. t/step: 4.24944e-01
 @simulation.run: Average timings at MD step      58. t/step: 3.85455e-01
 @simulation.run: Average timings at MD step      59. t/step: 4.22533e-01
 @simulation.run: Average timings at MD step      60. t/step: 4.18548e-01
 @simulation.run: Average timings at MD step      61. t/step: 4.42509e-01
 @simulation.run: Average timings at MD step      62. t/step: 4.04360e-01
 @simulation.run: Average timings at MD step      63. t/step: 5.21736e-01
 @simulation.run: Average timings at MD step      64. t/step: 4.15643e-01
 @simulation.run: Average timings at MD step      65. t/step: 4.38487e-01
 @simulation.run: Average timings at MD step      66. t/step: 4.12133e-01
 @simulation.run: Average timings at MD step      67. t/step: 4.43525e-01
 @simulation.run: Average timings at MD step      68. t/step: 4.06933e-01
 @simulation.run: Average timings at MD step      69. t/step: 4.41717e-01
 @simulation.run: Average timings at MD step      70. t/step: 3.98751e-01
 @simulation.run: Average timings at MD step      71. t/step: 4.23443e-01
 @simulation.run: Average timings at MD step      72. t/step: 3.90196e-01
 @simulation.run: Average timings at MD step      73. t/step: 5.02678e-01
 @simulation.run: Average timings at MD step      74. t/step: 8.09450e-01
 @simulation.run: Average timings at MD step      75. t/step: 4.25912e-01
 @simulation.run: Average timings at MD step      76. t/step: 3.94185e-01
 @simulation.run: Average timings at MD step      77. t/step: 5.15807e-01
 @simulation.run: Average timings at MD step      78. t/step: 4.05314e-01
 @simulation.run: Average timings at MD step      79. t/step: 5.17655e-01
</pre></div>
</div>
<p>The simulation generates output files that can be parsed and visualized from Python.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">read_output</span><span class="p">(</span><span class="s2">&quot;nvt_atomxc.out&quot;</span><span class="p">)</span>
<span class="n">trj</span> <span class="o">=</span> <span class="n">read_trajectory</span><span class="p">(</span><span class="s2">&quot;nvt_atomxc.pos_0.xyz&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;potential&quot;</span><span class="p">],</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;potential&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;conserved&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;conserved&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;t / ps&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;energy / ev&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_pet-mad_002.png" srcset="../../_images/sphx_glr_pet-mad_002.png" alt="pet mad" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> @process_units: Interpreting input with dimension length, units angstrom and cell units angstrom
 @process_units: Interpreting input with dimension length, units angstrom and cell units angstrom
 @process_units: Interpreting input with dimension length, units angstrom and cell units angstrom
 @process_units: Interpreting input with dimension length, units angstrom and cell units angstrom
 @process_units: Interpreting input with dimension length, units angstrom and cell units angstrom

&lt;matplotlib.legend.Legend object at 0x7f1121ec7e60&gt;
</pre></div>
</div>
<p>The trajectory (which is started from oxygen molecules placed on top of the surface)
shows quick relaxation to an oxide layer. If you look carefully, you’ll also see that
Mg and Si atoms tend to cluster together, and accumulate at the surface.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">chemiscope</span><span class="o">.</span><span class="n">show</span><span class="p">(</span>
    <span class="n">structures</span><span class="o">=</span><span class="n">trj</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">][::</span><span class="mi">10</span><span class="p">],</span>
        <span class="s2">&quot;potential&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;potential&quot;</span><span class="p">][::</span><span class="mi">10</span><span class="p">],</span>
        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">][::</span><span class="mi">10</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">settings</span><span class="o">=</span><span class="n">chemiscope</span><span class="o">.</span><span class="n">quick_settings</span><span class="p">(</span>
        <span class="n">map_settings</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">},</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="s2">&quot;potential&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">},</span>
        <span class="p">},</span>
        <span class="n">structure_settings</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;unitCell&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">trajectory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>


<!-- Error display -->
<div id="chsp-7b86c5ae-4b50-4ffd-ad0f-03b8b7ba724e-error-display" class="chemiscope-sphinx-error">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-7b86c5ae-4b50-4ffd-ad0f-03b8b7ba724e-error-display')">
        &times;
    </button>
</div>

<!-- Warning Display -->
<div id="chsp-7b86c5ae-4b50-4ffd-ad0f-03b8b7ba724e-warning-display" class="chemiscope-sphinx-warning">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-7b86c5ae-4b50-4ffd-ad0f-03b8b7ba724e-warning-display')">
        &times;
    </button>
</div>
<div style="padding: 0.5rem 1.25rem" />

<!-- Loading Spinner -->
<div id="chsp-7b86c5ae-4b50-4ffd-ad0f-03b8b7ba724e-loading" class="chemiscope-sphinx-spinner">
    <img src="../../_static/chemiscope-loading.svg" alt="Loading icon" />
</div>

<!-- Chemiscope Visualization -->
<div id="chsp-7b86c5ae-4b50-4ffd-ad0f-03b8b7ba724e">
    <!-- This will be replaced by the chemiscope HTML -->
</div>

<!-- Load Visualization Script -->
<script>
    loadChemiscopeSphinx('chsp-7b86c5ae-4b50-4ffd-ad0f-03b8b7ba724e', '../../_datasets/666938ea42358606f108bb8e5903793ac7402e535b877749ffb54bfd3e6515e4-fig_pet-mad_004.json.gz', 'default', '2000.0');
</script>
<div class="output_subarea output_html rendered_html output_result">

</div>
<br />
<br /></section>
<section id="molecular-dynamics-with-lammps">
<h3>Molecular dynamics with <code class="docutils literal notranslate"><span class="pre">LAMMPS</span></code><a class="headerlink" href="#molecular-dynamics-with-lammps" title="Link to this heading">¶</a></h3>
<p>We now run the same MD with <a class="reference external" href="https://lammps.org">LAMMPS</a>. To run a LAMMPS
calculation with a <code class="docutils literal notranslate"><span class="pre">metatomic</span></code> potential, one needs a LAMMPS build that contains an
appropriate pair style. You can compile it from <a class="reference external" href="https://github.com/metatensor/lammps">source</a>, or fetch it from the <cite>metatensor</cite> channel on
conda. One can then just include in the input a <code class="docutils literal notranslate"><span class="pre">pair_style</span> <span class="pre">metatomic</span></code> that points
to the exported model and a single <code class="docutils literal notranslate"><span class="pre">pair_coeff</span></code> command that specifies the mapping
from LAMMPS types to the atomic types the model can handle. The first two arguments
must be <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">*</span></code> so as to span all LAMMPS atom types. This is followed by a list of N
arguments that specify the mapping of metatomic atomic types to LAMMPS types, where N
is the number of LAMMPS atom types.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/al6xxx-o2.in&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>units metal  # Angstroms, eV, picoseconds
atom_style atomic
read_data al6xxx-o2.data
# loads pet-mad-model
pair_style metatomic &amp;
    pet-mad-v1.0.2.pt &amp;
    device cpu &amp;
    extensions extensions/
# define interactions between all atoms and maps the LAMMPS types to elements
pair_coeff * *  13 12 8 14
neighbor 2.0 bin
timestep 0.005
dump myDump all xyz 10 trajectory.xyz
dump_modify myDump element Al Mg O Si
thermo_style multi
thermo 1
velocity all create 800 87287 mom yes rot yes
fix 1 all nvt temp 800 800 0.10
# fix 2 all atom/swap 1 1 12345 800 types 1 2
# fix 2 all atom/swap 1 1 12345 800 types 1 3
# fix 2 all atom/swap 1 1 12345 800 types 1 4
run 80
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be aware that the extensions are compiled files and depend on your operating system.
Usually you have re-export the extensions for different systems! You can do this
by running the appropriate parts of this file, or using the <code class="docutils literal notranslate"><span class="pre">mtt</span> <span class="pre">export</span></code>
command-line utility.</p>
</div>
<p>We also save the geometry to a LAMMPS data file and finally run the simulation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;al6xxx-o2.data&quot;</span><span class="p">,</span> <span class="n">al_surface</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;lammps-data&quot;</span><span class="p">,</span> <span class="n">masses</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">subprocess</span><span class="o">.</span><span class="n">check_call</span><span class="p">([</span><span class="s2">&quot;lmp&quot;</span><span class="p">,</span> <span class="s2">&quot;-in&quot;</span><span class="p">,</span> <span class="s2">&quot;data/al6xxx-o2.in&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
<p>The resulting trajectory is qualitatively consistent with what
we observed with <code class="docutils literal notranslate"><span class="pre">i-PI</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lmp_trj</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;trajectory.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="n">chemiscope</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">structures</span><span class="o">=</span><span class="n">lmp_trj</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;structure&quot;</span><span class="p">)</span>
</pre></div>
</div>


<!-- Error display -->
<div id="chsp-c81ccec0-8e4f-4644-9b1f-b131c511293a-error-display" class="chemiscope-sphinx-error">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-c81ccec0-8e4f-4644-9b1f-b131c511293a-error-display')">
        &times;
    </button>
</div>

<!-- Warning Display -->
<div id="chsp-c81ccec0-8e4f-4644-9b1f-b131c511293a-warning-display" class="chemiscope-sphinx-warning">
    <p></p>
    <button type="button" aria-label="Close" onclick="hideElement('chsp-c81ccec0-8e4f-4644-9b1f-b131c511293a-warning-display')">
        &times;
    </button>
</div>
<div style="padding: 0.5rem 1.25rem" />

<!-- Loading Spinner -->
<div id="chsp-c81ccec0-8e4f-4644-9b1f-b131c511293a-loading" class="chemiscope-sphinx-spinner">
    <img src="../../_static/chemiscope-loading.svg" alt="Loading icon" />
</div>

<!-- Chemiscope Visualization -->
<div id="chsp-c81ccec0-8e4f-4644-9b1f-b131c511293a">
    <!-- This will be replaced by the chemiscope HTML -->
</div>

<!-- Load Visualization Script -->
<script>
    loadChemiscopeSphinx('chsp-c81ccec0-8e4f-4644-9b1f-b131c511293a', '../../_datasets/084310352cc38c2e87a974a539c5a6e7fe12ff8ecc3f2f380420344417859a63-fig_pet-mad_005.json.gz', 'structure', '2000.0');
</script>
<div class="output_subarea output_html rendered_html output_result">

</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (2 minutes 6.212 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-pet-mad-pet-mad-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1c8cf462c1ac9e99d56eec5b597f60b4/pet-mad.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">pet-mad.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/66a211ca4b06b0ab267a7bbcd26d4156/pet-mad.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">pet-mad.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e6c176ff5cfc026be833e0f96c2b6ab9/pet-mad.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">recipe:</span> <span class="pre">pet-mad.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../pet-mad-uq/pet-mad-uq.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Uncertainty Quantification with PET-MAD</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../sample-selection/sample-selection.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Sample and Feature Selection with FPS and CUR</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; BSD 3-Clause License, Copyright (c) 2026, The atomistic cookbook team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">The PET-MAD universal potential</a><ul>
<li><a class="reference internal" href="#inference-on-the-mad-test-set">Inference on the MAD test set</a><ul>
<li><a class="reference internal" href="#load-the-dataset">Load the dataset</a></li>
<li><a class="reference internal" href="#single-point-energy-and-forces">Single point energy and forces</a></li>
<li><a class="reference internal" href="#how-about-equivariance">How about equivariance‽</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulating-a-complex-surface">Simulating a complex surface</a><ul>
<li><a class="reference internal" href="#geometry-optimization-with-ase">Geometry optimization with <code class="docutils literal notranslate"><span class="pre">ASE</span></code></a></li>
<li><a class="reference internal" href="#molecular-dynamics-with-atoms-exchange-with-i-pi">Molecular dynamics with atoms exchange with <code class="docutils literal notranslate"><span class="pre">i-PI</span></code></a></li>
<li><a class="reference internal" href="#molecular-dynamics-with-lammps">Molecular dynamics with <code class="docutils literal notranslate"><span class="pre">LAMMPS</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script data-domain="atomistic-cookbook.org" defer="defer" src="https://plausible.io/js/script.file-downloads.hash.outbound-links.pageview-props.tagged-events.js"></script>
    <script src="../../_static/all-examples-data.js?v=01c87ff6"></script>
    <script src="../../_static/daily-recipe.js?v=b5e71911"></script>
    </body>
</html>